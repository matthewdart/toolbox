{
  "name": "media.download_video",
  "description": "Download a video from a URL to a local file using yt-dlp (supports many platforms) and return resolved file paths + metadata.",
  "version": "v1",
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "url": {
        "type": "string",
        "description": "Video page URL or direct media URL."
      },
      "output_dir": {
        "type": [
          "string",
          "null"
        ],
        "description": "Directory where downloads are written. Defaults to ./downloads.",
        "default": null
      },
      "filename_template": {
        "type": [
          "string",
          "null"
        ],
        "description": "Optional yt-dlp output template (e.g. \"%(title)s [%(id)s].%(ext)s\"). If null, a default template is used.",
        "default": null
      },
      "format": {
        "type": "string",
        "description": "yt-dlp format selector.",
        "default": "bestvideo+bestaudio/best"
      },
      "cookies_path": {
        "type": [
          "string",
          "null"
        ],
        "description": "Optional path to a Netscape-format cookies.txt file for authenticated downloads.",
        "default": null
      },
      "headers": {
        "type": [
          "object",
          "null"
        ],
        "description": "Optional HTTP headers to send. Values must be strings.",
        "default": null,
        "additionalProperties": {
          "type": "string"
        }
      },
      "user_agent": {
        "type": [
          "string",
          "null"
        ],
        "description": "Convenience: set the User-Agent header.",
        "default": null
      },
      "referer": {
        "type": [
          "string",
          "null"
        ],
        "description": "Convenience: set the Referer header.",
        "default": null
      },
      "allow_playlist": {
        "type": "boolean",
        "description": "Allow downloading playlist/multi-entry pages.",
        "default": false
      },
      "download": {
        "type": "boolean",
        "description": "If false, only extract metadata (no download).",
        "default": true
      },
      "overwrite": {
        "type": "boolean",
        "description": "If true, overwrite existing files.",
        "default": false
      },
      "quiet": {
        "type": "boolean",
        "description": "Reduce downloader output.",
        "default": false
      },
      "write_info_json": {
        "type": "boolean",
        "description": "When true, write a JSON metadata file to output_dir.",
        "default": true
      }
    },
    "required": [
      "url"
    ]
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "output_dir": {
        "type": "string"
      },
      "requested_url": {
        "type": "string"
      },
      "info_json": {
        "type": [
          "string",
          "null"
        ],
        "default": null
      },
      "files": {
        "type": "array",
        "default": [],
        "items": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "id": {
              "type": [
                "string",
                "null"
              ]
            },
            "title": {
              "type": [
                "string",
                "null"
              ]
            },
            "webpage_url": {
              "type": [
                "string",
                "null"
              ]
            },
            "extractor": {
              "type": [
                "string",
                "null"
              ]
            },
            "duration_seconds": {
              "type": [
                "number",
                "null"
              ]
            },
            "ext": {
              "type": [
                "string",
                "null"
              ]
            },
            "filesize_bytes": {
              "type": [
                "number",
                "null"
              ]
            },
            "path": {
              "type": [
                "string",
                "null"
              ]
            },
            "downloaded": {
              "type": "boolean"
            }
          },
          "required": [
            "id",
            "title",
            "webpage_url",
            "extractor",
            "duration_seconds",
            "ext",
            "filesize_bytes",
            "path",
            "downloaded"
          ]
        }
      }
    },
    "required": [
      "output_dir",
      "requested_url",
      "info_json",
      "files"
    ]
  },
  "errors": [
    {
      "code": "validation_error",
      "description": "Input did not match schema."
    },
    {
      "code": "output_validation_error",
      "description": "Output did not match schema."
    },
    {
      "code": "capability_error",
      "description": "Download failed (missing yt-dlp, auth required, DRM, network errors, etc.)."
    }
  ],
  "side_effects": "Performs network calls to fetch video metadata and optionally downloads media files to output_dir; may write an info.json file when write_info_json=true.",
  "version_notes": "v1 initial implementation (Prototype Mode)."
}

