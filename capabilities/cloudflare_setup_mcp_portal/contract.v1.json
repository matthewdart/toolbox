{
  "name": "cloudflare.setup_mcp_portal",
  "description": "Manage Cloudflare MCP Portal servers and portals via the Cloudflare API. Supports listing, adding, updating, syncing, and removing servers, managing portal-to-server assignments, and verifying end-to-end portal health.",
  "version": "v1",
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "command": {
        "type": "string",
        "enum": [
          "list_servers",
          "list_portals",
          "get_portal",
          "add_server",
          "update_server",
          "sync_server",
          "remove_server",
          "update_portal_servers",
          "verify_portal"
        ],
        "description": "The subcommand to execute."
      },
      "account_id": {
        "type": [
          "string",
          "null"
        ],
        "description": "Cloudflare account ID. Defaults to CLOUDFLARE_ACCOUNT_ID env var if not provided.",
        "default": null
      },
      "name": {
        "type": [
          "string",
          "null"
        ],
        "description": "Display name for the MCP server. Required for add_server.",
        "default": null
      },
      "url": {
        "type": [
          "string",
          "null"
        ],
        "description": "MCP server URL (e.g. https://host/mcp). Required for add_server, optional for update_server.",
        "default": null
      },
      "auth_type": {
        "type": [
          "string",
          "null"
        ],
        "description": "Auth type for the MCP server (default: unauthenticated). Used by add_server and update_server.",
        "default": "unauthenticated"
      },
      "server_id": {
        "type": [
          "string",
          "null"
        ],
        "description": "Server ID. Required for sync_server, remove_server, and update_server. Optional for add_server (defaults to name).",
        "default": null
      },
      "portal_id": {
        "type": [
          "string",
          "null"
        ],
        "description": "Portal ID. Required for get_portal, update_portal_servers, and verify_portal.",
        "default": null
      },
      "server_ids": {
        "type": [
          "array",
          "null"
        ],
        "items": {
          "type": "string"
        },
        "description": "List of server IDs to assign to the portal. Required for update_portal_servers. Replaces the full server list.",
        "default": null
      }
    },
    "required": [
      "command"
    ]
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "command": {
        "type": "string",
        "description": "The command that was executed."
      },
      "account_id": {
        "type": "string",
        "description": "The Cloudflare account ID that was targeted."
      },
      "result": {
        "description": "API response payload. A list for list commands, an object for mutations."
      },
      "count": {
        "type": "integer",
        "description": "Number of items returned (list commands only)."
      },
      "error": {
        "type": "string",
        "description": "Error message, if any."
      }
    },
    "required": [
      "command",
      "account_id",
      "result"
    ]
  },
  "errors": [
    {
      "code": "auth_error",
      "description": "Cloudflare credentials not found in environment variables."
    },
    {
      "code": "validation_error",
      "description": "Missing or invalid parameters for the requested command."
    },
    {
      "code": "api_error",
      "description": "Cloudflare API returned an error response."
    }
  ],
  "side_effects": "Registers, updates, syncs, or removes MCP servers and portal assignments in the Cloudflare account via API calls. List and get commands are read-only.",
  "version_notes": "v1.1 added get_portal, update_portal_servers, update_server commands; account_id defaults from CLOUDFLARE_ACCOUNT_ID env var. v1.2 added verify_portal command for end-to-end health checks."
}
