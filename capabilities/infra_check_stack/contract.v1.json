{
  "name": "infra.check_stack",
  "description": "Check Docker Compose service status locally.",
  "version": "v1",
  "annotations": {
    "title": "Check Docker Compose Stack",
    "readOnlyHint": true,
    "idempotentHint": true
  },
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "compose_dir": {
        "type": "string",
        "description": "Absolute path to the Docker Compose project directory."
      },
      "services": {
        "type": [
          "array",
          "null"
        ],
        "description": "List of service names to query. If null or empty, all services in the compose file are returned.",
        "items": {
          "type": "string"
        },
        "default": null
      }
    },
    "required": [
      "compose_dir"
    ]
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "compose_dir": {
        "type": "string",
        "description": "Absolute path to the Docker Compose project directory."
      },
      "service_count": {
        "type": "integer",
        "description": "Number of services returned."
      },
      "services": {
        "type": "array",
        "description": "Normalized service status entries.",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "Container name."
            },
            "service": {
              "type": "string",
              "description": "Compose service name."
            },
            "status": {
              "type": "string",
              "description": "Container state (e.g. running, exited)."
            },
            "health": {
              "type": "string",
              "description": "Health check status, if available."
            },
            "ports": {
              "description": "Published port mappings."
            },
            "image": {
              "type": "string",
              "description": "Container image name."
            }
          }
        }
      },
      "error": {
        "type": "string",
        "description": "Error message, if the command failed."
      },
      "exit_code": {
        "type": "integer",
        "description": "Exit code from the command, present only on failure."
      }
    },
    "required": [
      "compose_dir"
    ]
  },
  "errors": [
    {
      "code": "dependency_error",
      "description": "docker not found in PATH."
    }
  ],
  "side_effects": "Runs a read-only docker compose ps command locally. No containers are started, stopped, or modified.",
  "version_notes": "v1 migrated from stack-status skill script."
}
