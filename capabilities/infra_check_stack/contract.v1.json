{
  "name": "infra.check_stack",
  "description": "Check Docker Compose service status on a remote host via SSH.",
  "version": "v1",
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "host": {
        "type": "string",
        "description": "SSH host target (e.g. user@hostname or an SSH config alias)."
      },
      "compose_dir": {
        "type": "string",
        "description": "Absolute path to the Docker Compose project directory on the remote host."
      },
      "services": {
        "type": [
          "array",
          "null"
        ],
        "description": "List of service names to query. If null or empty, all services in the compose file are returned.",
        "items": {
          "type": "string"
        },
        "default": null
      }
    },
    "required": [
      "host",
      "compose_dir"
    ]
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "host": {
        "type": "string",
        "description": "The SSH host that was queried."
      },
      "compose_dir": {
        "type": "string",
        "description": "The remote compose directory."
      },
      "service_count": {
        "type": "integer",
        "description": "Number of services returned."
      },
      "services": {
        "type": "array",
        "description": "Normalized service status entries.",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "Container name."
            },
            "service": {
              "type": "string",
              "description": "Compose service name."
            },
            "status": {
              "type": "string",
              "description": "Container state (e.g. running, exited)."
            },
            "health": {
              "type": "string",
              "description": "Health check status, if available."
            },
            "ports": {
              "description": "Published port mappings."
            },
            "image": {
              "type": "string",
              "description": "Container image name."
            }
          }
        }
      },
      "error": {
        "type": "string",
        "description": "Error message from the remote host, if the command failed."
      },
      "exit_code": {
        "type": "integer",
        "description": "Exit code from the remote SSH command, present only on failure."
      }
    },
    "required": [
      "host",
      "compose_dir"
    ]
  },
  "errors": [
    {
      "code": "dependency_error",
      "description": "ssh binary not found in PATH."
    },
    {
      "code": "ssh_error",
      "description": "SSH connection or remote command execution failed."
    }
  ],
  "side_effects": "Runs a read-only docker compose ps command on the remote host via SSH. No containers are started, stopped, or modified.",
  "version_notes": "v1 migrated from stack-status skill script."
}
